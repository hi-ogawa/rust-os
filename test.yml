- name: dev
  command: make -s run example=dev qemu_options='-display none' cargo_options='--features os-test'
  stdout: |
    hello serial
    BEFORE int3
    BREAKPOINT: error_code = 0
    AFTER int3

- name: idt
  command: make -s run example=idt qemu_options='-display none' cargo_options='--features os-test'
  stdout: |
    BEFORE `idt.load`
    AFTER `idt.load`
    BEFORE `int3` (1)
    BREAKPOINT: error_code = 0, counter = 1
    AFTER `int3` (1)
    BEFORE `int3` (2)
    BREAKPOINT: error_code = 0, counter = 2
    AFTER `int3` (2)
    BEFORE page fault
    PAGE_FAULT: error_code = 2, cr2 = 0xdeadbeaf

- name: panic
  command: make -s run example=panic qemu_options='-display none' cargo_options='--features os-test'
  stdout: |
    panicked at 'assertion failed: `(left == right)`
      left: `3`,
     right: `0`', examples/panic.rs:23:5

- name: fmt
  command: make -s run example=fmt qemu_options='-display none' cargo_options='--features os-test'
  stdout: |
    1 / 3 = 0.3333333333333333

- name: uart
  command: make -s run example=uart qemu_options='-display none' cargo_options='--features os-test'
  stdout: |
    Hello World!

- name: double_fault
  command: make -s run example=double_fault qemu_options='-display none' cargo_options='--features os-test'
  stdout: |
    DOUBLE_FAULT: error_code = 0

- name: multiboot
  command: make -s run example=multiboot qemu_options='-display none' cargo_options='--features os-test'
  stdout: |
    sizeof(BootInfo) = 116
    address = 0x00010000
    flags = 0b1101001100111
    framebuffer = (0xb8000, 80, 25)
    mmap_addr = 65692
    mmap_length = 144
    mmap: addr = 0x00000000, length = 0x0009fc00, type = 1
    mmap: addr = 0x0009fc00, length = 0x00000400, type = 2
    mmap: addr = 0x000f0000, length = 0x00010000, type = 2
    mmap: addr = 0x00100000, length = 0x07ee0000, type = 1
    mmap: addr = 0x07fe0000, length = 0x00020000, type = 2
    mmap: addr = 0xfffc0000, length = 0x00040000, type = 2
    section: addr = 0x00100000
